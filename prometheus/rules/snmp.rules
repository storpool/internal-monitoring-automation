---
groups:
  - name: SNMP Rules
    rules:
      - alert: InterfaceStatusChange
        expr: 'ifOperStatus == 0'
        for: 0s
        labels:
          severity: warning
        annotations:
          summary: 'Interface operational state change'
          description: 'Interface `{{ $labels.ifName }}` on `{{ $labels.instance }}` state has changed'

      - alert: InterfaceHighBandwithUtilization
        expr: '(irate(ifHCInOctets{ifName!~".*CPU.*"}[2m])) / (ifHighSpeed * 10^6/8) > 0.9 or (irate(ifHCOutOctets{ifName!~".*CPU.*"}[2m])) / (ifHighSpeed * 10^6/8) > 0.9'
        for: 30s
        labels:
          severity: warning
        annotations:
          summary: 'Interface has bandwidth utilization more than 90% for the last 30 seconds'
          description: 'Interface `{{ $labels.ifName }}` on `{{ $labels.instance }}` is using X% of its bandwidth'
